2022-08-15 11:48:53,599 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:48:53,599 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:49:05,583 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:49:05,583 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:49:05,583 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:49:05,585 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:49:05,585 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:49:05,585 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:49:09,180 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:49:09,180 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:49:09,180 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:49:25,470 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:49:25,470 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:49:25,470 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:49:25,470 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:49:25,472 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:49:25,472 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:49:25,472 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:49:25,472 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:49:28,941 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:49:28,941 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:49:28,941 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:49:28,941 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:49:28,946 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:49:28,946 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:49:28,946 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:49:28,946 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:49:28,949 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:49:28,949 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:49:28,949 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:49:28,949 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:49:28,954 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:49:28,954 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:49:28,954 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:49:28,954 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:49:28,958 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:49:28,958 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:49:28,958 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:49:28,958 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:15,420 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:15,420 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:15,420 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:15,420 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:15,420 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:15,424 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:15,424 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:15,424 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:15,424 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:15,424 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:18,852 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:18,852 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:18,852 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:18,852 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:18,852 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:18,863 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:18,863 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:18,863 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:18,863 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:18,863 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:18,870 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:18,870 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:18,870 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:18,870 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:18,870 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:18,878 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:18,878 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:18,878 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:18,878 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:18,878 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:18,884 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:18,884 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:18,884 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:18,884 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:18,884 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:32,084 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:32,084 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:32,084 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:32,084 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:32,084 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:32,084 maskrcnn_benchmark INFO: Using 1 GPUs
2022-08-15 11:50:32,091 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:32,091 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:32,091 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:32,091 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:32,091 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:32,091 maskrcnn_benchmark INFO: Collecting env info (might take some time)
2022-08-15 11:50:35,542 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:35,542 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:35,542 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:35,542 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:35,542 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:35,542 maskrcnn_benchmark INFO: 
PyTorch version: 1.7.1
Is debug build: False
CUDA used to build PyTorch: 11.0
ROCM used to build PyTorch: N/A

OS: Ubuntu 20.04.3 LTS (x86_64)
GCC version: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0
Clang version: Could not collect
CMake version: version 3.22.2

Python version: 3.7 (64-bit runtime)
Is CUDA available: True
CUDA runtime version: Could not collect
GPU models and configuration: GPU 0: NVIDIA GeForce RTX 3090
Nvidia driver version: 470.74
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] numpy==1.21.5
[pip3] torch==1.12.1
[pip3] torchaudio==0.7.0a0+a853dff
[pip3] torchvision==0.8.0a0
[conda] _pytorch_select           0.1                       cpu_0  
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.0.221             h6bb024c_0  
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py37h7f8727e_0  
[conda] mkl_fft                   1.3.1            py37hd3c417c_0  
[conda] mkl_random                1.2.2            py37h51133e4_0  
[conda] numpy                     1.21.5           py37h6c91a56_3  
[conda] numpy-base                1.21.5           py37ha15fc14_3  
[conda] pytorch                   1.7.1           py3.7_cuda11.0.221_cudnn8.0.5_0    pytorch
[conda] torch                     1.12.1                   pypi_0    pypi
[conda] torchaudio                0.7.2                      py37    pytorch
[conda] torchvision               0.8.2           cpu_py37ha229d99_0
        Pillow (9.2.0)
2022-08-15 11:50:35,551 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:35,551 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:35,551 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:35,551 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:35,551 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:35,551 maskrcnn_benchmark INFO: Loaded configuration file ../sgg_configs/vg_vrd/rel_danfeiX_FPN50_vltranse.yaml
2022-08-15 11:50:35,558 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:35,558 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:35,558 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:35,558 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:35,558 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:35,558 maskrcnn_benchmark INFO: 
MODEL:
  META_ARCHITECTURE: "SceneParser"
  WEIGHT: "models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth"
  USE_FREQ_PRIOR: False
  FREQ_PRIOR: "visualgenome/label_danfeiX_clipped.freq_prior.npy"
  RESNETS:
    TRANS_FUNC: "BottleneckWithFixedBatchNorm"
    BACKBONE_OUT_CHANNELS: 256
  BACKBONE:
    CONV_BODY: "R-50-FPN"
  ATTRIBUTE_ON: False
  RELATION_ON: True
  RPN:
    USE_FPN: True
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    PRE_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TEST: 1000
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    POSITIVE_FRACTION: 0.5
    USE_FPN: True
    SCORE_THRESH: 0.05 # 0.0001
    DETECTIONS_PER_IMG: 100 # 600
    MIN_DETECTIONS_PER_IMG: 1
  ROI_BOX_HEAD:
    NUM_CLASSES: 151
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPFeatureExtractor"
    PREDICTOR: "FPNPredictor"
    MLP_HEAD_DIM: 1024
  ATTRIBUTE_ON: False
  RELATION_ON: True
  ROI_RELATION_HEAD:
    DETECTOR_PRE_CALCULATED: False
    FORCE_RELATIONS: False
    ALGORITHM: "sg_vltranse"
    MODE: 'sgdet'
    USE_BIAS: False
    FILTER_NON_OVERLAP: True
    UPDATE_BOX_REG: False
    SHARE_CONV_BACKBONE: False
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    NUM_CLASSES: 51 # 10
    POOLER_RESOLUTION: 7
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POOLER_SAMPLING_RATIO: 2
    FEATURE_EXTRACTOR: "FPN2MLPRelationFeatureExtractor"
    PREDICTOR: "FPNRelationPredictor"
    CONTRASTIVE_LOSS:
      USE_FLAG: True
    TRIPLETS_PER_IMG: 100
    POSTPROCESS_METHOD: 'constrained' # previously it's unconstrained 
INPUT:
  MIN_SIZE_TRAIN: (600,)
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MAX_SIZE_TEST: 1000
  PIXEL_MEAN: [103.530, 116.280, 123.675]
DATASETS:
  FACTORY_TRAIN: ("VGTSVDataset",)
  FACTORY_TEST: ("VGTSVDataset",)
  TRAIN: ("visualgenome/train_danfeiX_relation_nm.yaml",)
  TEST: ("visualgenome/test_danfeiX_relation.yaml",)
DATALOADER:
  SIZE_DIVISIBILITY: 32
  NUM_WORKERS: 4
SOLVER:
  BASE_LR: 0.015
  WEIGHT_DECAY: 0.0001
  MAX_ITER: 40000
  STEPS: (20000,30000)
  IMS_PER_BATCH: 1
  CHECKPOINT_PERIOD: 5000
TEST:
  IMS_PER_BATCH: 1
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
  GATHER_ON_CPU: True
  SKIP_PERFORMANCE_EVAL: False
  OUTPUT_RELATION_FEATURE: False
  OUTPUT_FEATURE: True # need this to output scores_all and box_all
OUTPUT_DIR: "./models/relation_danfeiX_FPN50/"
DATA_DIR: "./datasets"
DISTRIBUTED_BACKEND: 'gloo'
2022-08-15 11:50:35,566 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:35,566 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:35,566 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:35,566 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:35,566 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:35,566 maskrcnn_benchmark INFO: Running with config:
DATALOADER:
  ASPECT_RATIO_GROUPING: True
  NUM_WORKERS: 4
  SIZE_DIVISIBILITY: 32
DATASETS:
  FACTORY_TEST: ('VGTSVDataset',)
  FACTORY_TRAIN: ('VGTSVDataset',)
  LABELMAP_FILE: 
  TEST: ('visualgenome/test_danfeiX_relation.yaml',)
  TRAIN: ('visualgenome/train_danfeiX_relation_nm.yaml',)
DATA_DIR: ./datasets
DISTRIBUTED_BACKEND: gloo
DTYPE: float32
INPUT:
  BRIGHTNESS: 0.0
  CONTRAST: 0.0
  HORIZONTAL_FLIP_PROB_TRAIN: 0.5
  HUE: 0.0
  MAX_SIZE_TEST: 1000
  MAX_SIZE_TRAIN: 1000
  MIN_SIZE_TEST: 600
  MIN_SIZE_TRAIN: (600,)
  PIXEL_MEAN: [103.53, 116.28, 123.675]
  PIXEL_STD: [1.0, 1.0, 1.0]
  SATURATION: 0.0
  TO_BGR255: True
  VERTICAL_FLIP_PROB_TRAIN: 0.0
LOG_LOSS_PERIOD: 20
MODEL:
  ATTRIBUTE_ON: False
  BACKBONE:
    CONV_BODY: R-50-FPN
    FREEZE_CONV_BODY_AT: 2
  CLS_AGNOSTIC_BBOX_REG: False
  DEVICE: cuda
  FBNET:
    ARCH: default
    ARCH_DEF: 
    BN_TYPE: bn
    DET_HEAD_BLOCKS: []
    DET_HEAD_LAST_SCALE: 1.0
    DET_HEAD_STRIDE: 0
    DW_CONV_SKIP_BN: True
    DW_CONV_SKIP_RELU: True
    KPTS_HEAD_BLOCKS: []
    KPTS_HEAD_LAST_SCALE: 0.0
    KPTS_HEAD_STRIDE: 0
    MASK_HEAD_BLOCKS: []
    MASK_HEAD_LAST_SCALE: 0.0
    MASK_HEAD_STRIDE: 0
    RPN_BN_TYPE: 
    RPN_HEAD_BLOCKS: 0
    SCALE_FACTOR: 1.0
    WIDTH_DIVISOR: 1
  FPN:
    USE_GN: False
    USE_RELU: False
  FREQ_PRIOR: visualgenome/label_danfeiX_clipped.freq_prior.npy
  GROUP_NORM:
    DIM_PER_GP: -1
    EPSILON: 1e-05
    NUM_GROUPS: 32
  KEYPOINT_ON: False
  MASK_ON: False
  META_ARCHITECTURE: SceneParser
  RELATION_ON: True
  RESNETS:
    BACKBONE_OUT_CHANNELS: 256
    DEFORMABLE_GROUPS: 1
    NUM_GROUPS: 1
    RES2_OUT_CHANNELS: 256
    RES5_DILATION: 1
    STAGE_WITH_DCN: (False, False, False, False)
    STEM_FUNC: StemWithFixedBatchNorm
    STEM_OUT_CHANNELS: 64
    STRIDE_IN_1X1: True
    TRANS_FUNC: BottleneckWithFixedBatchNorm
    WIDTH_PER_GROUP: 64
    WITH_MODULATED_DCN: False
  RETINANET:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDES: (8, 16, 32, 64, 128)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BBOX_REG_BETA: 0.11
    BBOX_REG_WEIGHT: 4.0
    BG_IOU_THRESHOLD: 0.4
    FG_IOU_THRESHOLD: 0.5
    INFERENCE_TH: 0.05
    LOSS_ALPHA: 0.25
    LOSS_GAMMA: 2.0
    NMS_TH: 0.4
    NUM_CLASSES: 81
    NUM_CONVS: 4
    OCTAVE: 2.0
    PRE_NMS_TOP_N: 1000
    PRIOR_PROB: 0.01
    SCALES_PER_OCTAVE: 3
    STRADDLE_THRESH: 0
    USE_C5: True
  RETINANET_ON: False
  ROI_ATTRIBUTE_HEAD:
    ATTR_EMD_DIM: 512
    CLS_EMD_DIM: 256
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    LOSS_WEIGHT: 0.5
    MAX_NUM_ATTR_PER_IMG: 100
    MAX_NUM_ATTR_PER_OBJ: 16
    MLP_HEAD_DIM: 1024
    NUM_ATTRIBUTES: 401
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_ATTRIBUTES_THRESHOLD: 0.0
    PREDICTOR: AttributeRCNNPredictor
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_BOX_HEAD:
    CONV_HEAD_DIM: 256
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPFeatureExtractor
    FORCE_BOXES: False
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 151
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    PREDICTOR: FPNPredictor
    USE_GN: False
  ROI_HEADS:
    BATCH_SIZE_PER_IMAGE: 512
    BBOX_REG_WEIGHTS: (10.0, 10.0, 5.0, 5.0)
    BG_IOU_THRESHOLD: 0.5
    DETECTIONS_PER_IMG: 100
    FG_IOU_THRESHOLD: 0.5
    MIN_DETECTIONS_PER_IMG: 1
    NMS: 0.5
    NMS_FILTER: 0
    POSITIVE_FRACTION: 0.5
    SCORE_THRESH: 0.05
    USE_FPN: True
  ROI_KEYPOINT_HEAD:
    CONV_LAYERS: (512, 512, 512, 512, 512, 512, 512, 512)
    FEATURE_EXTRACTOR: KeypointRCNNFeatureExtractor
    MLP_HEAD_DIM: 1024
    NUM_CLASSES: 17
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    PREDICTOR: KeypointRCNNPredictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
  ROI_MASK_HEAD:
    CONV_LAYERS: (256, 256, 256, 256)
    DILATION: 1
    FEATURE_EXTRACTOR: ResNet50Conv5ROIFeatureExtractor
    MLP_HEAD_DIM: 1024
    POOLER_RESOLUTION: 14
    POOLER_SAMPLING_RATIO: 0
    POOLER_SCALES: (0.0625,)
    POSTPROCESS_MASKS: False
    POSTPROCESS_MASKS_THRESHOLD: 0.5
    PREDICTOR: MaskRCNNC4Predictor
    RESOLUTION: 14
    SHARE_BOX_FEATURE_EXTRACTOR: True
    USE_GN: False
  ROI_RELATION_HEAD:
    ALGORITHM: sg_vltranse
    BACKBONE_FREEZE_PARAMETER: True
    BATCH_SIZE_PER_IMAGE: 512
    CONCATENATE_PROPOSAL_GT: False
    CONTRASTIVE_LOSS:
      BG_THRESH_HI: 0.5
      BG_THRESH_LO: 0.0
      FG_REL_FRACTION: 0.25
      FG_REL_SIZE_PER_IM: 512
      FG_THRESH: 0.5
      NODE_CONTRASTIVE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_P_AWARE_WEIGHT: 0.1
      NODE_CONTRASTIVE_SO_AWARE_MARGIN: 0.2
      NODE_CONTRASTIVE_SO_AWARE_WEIGHT: 0.5
      NODE_CONTRASTIVE_WEIGHT: 1.0
      NODE_SAMPLE_SIZE: 128
      USE_BG: True
      USE_FLAG: True
      USE_FREQ_BIAS: True
      USE_NODE_CONTRASTIVE_LOSS: True
      USE_NODE_CONTRASTIVE_P_AWARE_LOSS: True
      USE_NODE_CONTRASTIVE_SO_AWARE_LOSS: True
      USE_SPATIAL_FEAT: False
      USE_SPO_AGNOSTIC_COMPENSATION: False
    CONV_HEAD_DIM: 256
    DETECTOR_BOX_THRESHOLD: 0.0
    DETECTOR_PRE_CALCULATED: False
    DILATION: 1
    FEATURE_EXTRACTOR: FPN2MLPRelationFeatureExtractor
    FILTER_NON_OVERLAP: True
    FORCE_RELATIONS: False
    GRCNN_FEATURE_UPDATE_STEP: 0
    GRCNN_SCORE_UPDATE_STEP: 0
    IMP_FEATURE_UPDATE_STEP: 0
    MLP_HEAD_DIM: 1024
    MODE: sgdet
    MSDN_FEATURE_UPDATE_STEP: 0
    NEURAL_MOTIF:
      DEBUG: False
      DROPOUT: 0.0
      EDGE_LSTM_NUM_LAYERS: 4
      EMBED_DIM: 100
      GLOVE_PATH: glove/
      HIDDEN_DIM: 256
      NUM_OBJS: 64
      OBJ_CLASSES_FN: visualgenome/label_danfeiX_clipped.obj_classes.txt
      OBJ_FEAT_TO_DECODER: False
      OBJ_FEAT_TO_EDGE: False
      OBJ_LSTM_NUM_LAYERS: 2
      ORDER: confidence
      POS_BATCHNORM_MOMENTUM: 0.001
      POS_EMBED_DIM: 128
      REL_CLASSES_FN: visualgenome/label_danfeiX_clipped.rel_classes.txt
      USE_TANH: False
    NUM_CLASSES: 51
    NUM_STACKED_CONVS: 4
    POOLER_RESOLUTION: 7
    POOLER_SAMPLING_RATIO: 2
    POOLER_SCALES: (0.25, 0.125, 0.0625, 0.03125)
    POSITIVE_FRACTION: 0.25
    POSTPROCESS_METHOD: constrained
    POSTPROCESS_SCORE_THRESH: 1e-05
    POST_RELPN_PREPOSALS: 512
    PREDICTOR: FPNRelationPredictor
    ROI_BOX_HEAD_FREEZE_PARAMETER: True
    RPN_FREEZE_PARAMETER: True
    SEPERATE_SO_FEATURE_EXTRACTOR: True
    SHARE_BOX_FEATURE_EXTRACTOR: False
    SHARE_CONV_BACKBONE: False
    TRIPLETS_PER_IMG: 100
    UPDATE_BOX_REG: False
    USE_BIAS: False
    USE_GN: False
    USE_ONLINE_OBJ_LABELS: False
    USE_RELPN: False
  RPN:
    ANCHOR_SIZES: (32, 64, 128, 256, 512)
    ANCHOR_STRIDE: (4, 8, 16, 32, 64)
    ASPECT_RATIOS: (0.5, 1.0, 2.0)
    BATCH_SIZE_PER_IMAGE: 256
    BG_IOU_THRESHOLD: 0.3
    FG_IOU_THRESHOLD: 0.7
    FORCE_BOXES: False
    FPN_POST_NMS_PER_BATCH: True
    FPN_POST_NMS_TOP_N_TEST: 1000
    FPN_POST_NMS_TOP_N_TRAIN: 2000
    MIN_SIZE: 0
    NMS_THRESH: 0.7
    POSITIVE_FRACTION: 0.5
    POST_NMS_TOP_N_TEST: 1000
    POST_NMS_TOP_N_TRAIN: 2000
    PRE_NMS_TOP_N_TEST: 1000
    PRE_NMS_TOP_N_TRAIN: 2000
    RPN_HEAD: SingleConvRPNHead
    STRADDLE_THRESH: 0
    USE_FPN: True
  RPN_ONLY: False
  TRANSFORMER:
    AVG_POOL: False
    DROP: 0.0
    DROP_PATH: 0.1
    MSVIT:
      ARCH: l1,h3,d96,n1,s1,g1,p4,f7,a0_l2,h3,d192,n2,s1,g1,p2,f7,a0_l3,h6,d384,n8,s1,g1,p2,f7,a0_l4,h12,d768,n1,s1,g0,p2,f7,a0
      ATTN_TYPE: longformerhand
      LN_EPS: 1e-06
      MODE: 0
      ONLY_GLOBAL: False
      REDRAW_INTERVAL: 1000
      SHARE_KV: True
      SHARE_W: True
      SW_EXACT: 0
    NORM_EMBED: True
    OUT_FEATURES: []
    VITHEADARCH: l4,h12,d768,n1,s0,g0,p2,f7,a0
  USE_FREQ_PRIOR: False
  WEIGHT: models/vgvrd/vgnm_usefpTrue_objctx0_edgectx2/reldn.pth
OUTPUT_DIR: ./models/relation_danfeiX_FPN50/
PATHS_CATALOG: /home/thanhtran/dev/scene_graph_benchmark/maskrcnn_benchmark/config/paths_catalog.py
SOLVER:
  BASE_LR: 0.015
  BIAS_LR_FACTOR: 2
  CHECKPOINT_PERIOD: 5000
  CLIP_GRADIENTS:
    CLIP_TYPE: full_model
    CLIP_VALUE: 1.0
    ENABLED: False
    NORM_TYPE: 2.0
  GAMMA: 0.1
  IMS_PER_BATCH: 1
  MAX_ITER: 40000
  MOMENTUM: 0.9
  OPTIMIZER: SGD
  STEPS: (20000, 30000)
  TEST_PERIOD: 0
  USE_AMP: False
  WARMUP_FACTOR: 0.3333333333333333
  WARMUP_ITERS: 500
  WARMUP_METHOD: linear
  WEIGHT_DECAY: 0.0001
  WEIGHT_DECAY_BIAS: 0
TEST:
  BBOX_AUG:
    ENABLED: False
    H_FLIP: False
    MAX_SIZE: 4000
    SCALES: ()
    SCALE_H_FLIP: False
  DETECTIONS_PER_IMG: 100
  EXPECTED_RESULTS: []
  EXPECTED_RESULTS_SIGMA_TOL: 4
  GATHER_ON_CPU: True
  IGNORE_BOX_REGRESSION: False
  IMS_PER_BATCH: 1
  OUTPUT_ATTRIBUTE_FEATURE: False
  OUTPUT_FEATURE: True
  OUTPUT_RELATION_FEATURE: False
  SAVE_PREDICTIONS: False
  SAVE_RESULTS_TO_TSV: True
  SKIP_PERFORMANCE_EVAL: False
  TSV_SAVE_SUBSET: ['rect', 'class', 'conf', 'relations', 'relation_scores', 'relation_scores_all']
2022-08-15 11:50:35,572 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:35,572 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:35,572 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:35,572 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:35,572 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
2022-08-15 11:50:35,572 maskrcnn_benchmark INFO: Saving config into: ./models/relation_danfeiX_FPN50/config.yml
